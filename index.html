<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Tool Stack</title>
    <style>
        /* --- RESET & GLOBAL FONTS --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Google Sans', 'Google Sans Text', 'Segoe UI', Helvetica, Arial, sans-serif;
        }

        body, html {
            height: 100%;
            overflow: hidden;
            display: flex;
            flex-direction: column; 
        }

        /* --- VIDEO BACKGROUND --- */
        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -2;
            background: #002d56;
        }
        
        .video-background iframe {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100vw;
            height: 56.25vw; 
            min-height: 100vh;
            min-width: 177.77vh;
            transform: translate(-50%, -50%);
            pointer-events: none;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(0, 45, 86, 0.1) 0%, rgba(0, 45, 86, 0.4) 100%);
            z-index: -1;
        }

        /* --- NAVIGATION --- */
        nav {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 50px 60px; 
            color: white;
            flex-shrink: 0; 
            z-index: 10;
        }

        body.interacting nav { display: none !important; }

        .logo-img {
            height: 130px !important; 
            min-height: 130px !important;
            width: auto !important;
            display: block;
        }

        /* --- MAIN LAYOUT --- EDGE TO EDGE --- */
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; 
            flex-grow: 1; 
            color: white;
            padding: 0 10px;
            max-width: 100%; 
            margin: 0 auto;
            width: 100%;
            transition: all 0.5s ease;
        }

        body.interacting .container {
            flex-direction: row; 
            align-items: flex-start; 
            justify-content: center; 
            padding: 20px 10px;
            gap: 15px;
        }

        h1 {
            font-size: 3.8rem;
            margin-bottom: 15px;
            font-weight: 300;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        p.subtitle {
            font-size: 1.6rem;
            margin-bottom: 20px; 
            opacity: 0.95;
            font-weight: 400;
            max-width: 700px;
            text-align: center;
        }

        body.interacting h1, body.interacting p.subtitle { display: none !important; }

        /* --- LENSES GRID (LEFT SIDEBAR) --- FIXED 230px --- */
        .lenses-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            width: 100%;
            max-width: 880px; 
            margin-bottom: 20px; 
            justify-content: center;
        }

        body.interacting .lenses-grid {
            display: flex;
            flex-direction: column;
            width: 230px; 
            margin-bottom: 0;
            flex-shrink: 0;
            gap: 10px;
        }

        .lens-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255,255,255,0.3);
            padding: 12px 15px; 
            height: 76px; 
            border-radius: 8px; 
            cursor: pointer;
            text-align: center; 
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .lens-card:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
        }

        .lens-card.active-lens {
            background: rgba(255, 255, 255, 0.35);
            border: 2px solid white;
        }

        .lens-title { 
            font-weight: 500; 
            font-size: 1.15rem; 
            display: block; 
            line-height: 1.15;
            color: white;
        }

        /* --- CHAT CONTAINER (CENTER) --- FLUID --- */
        .chat-container {
            width: 100%; 
            background: transparent; 
            height: 160px; 
            border-radius: 8px; 
            overflow: visible; 
            display: flex;
            flex-direction: column;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative; 
        }

        body.interacting .chat-container { 
            flex-grow: 1; 
            height: 96vh; 
            background: #ffffff; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden; 
        }

        .chat-header-lintel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 60px;
            background: linear-gradient(to bottom, #ffffff 60%, rgba(255, 255, 255, 0) 100%);
            z-index: 45;
            pointer-events: none;
            display: none;
        }
        body.interacting .chat-header-lintel { display: block; }

        /* --- ARTIFACTS PANEL (RIGHT SIDEBAR) --- FIXED 340px --- */
        .artifacts-panel {
            display: none;
            width: 340px; 
            height: 96vh;
            flex-shrink: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            overflow-y: auto;
            color: white;
        }

        body.interacting .artifacts-panel { display: flex; flex-direction: column; }

        .artifact-header {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
            opacity: 0.8;
            font-weight: 600;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 10px;
        }

        .artifact-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .artifact-card .type { font-size: 10px; font-weight: 700; color: #00D1FF; margin-bottom: 4px; }
        .artifact-card .title { font-size: 14px; font-weight: 500; margin-bottom: 8px; display: block; }
        .artifact-card .meta { font-size: 12px; opacity: 0.7; }

        /* --- CHAT INTERNAL STYLING --- */
        .chat-history {
            flex-grow: 1;
            padding: 60px 30px 180px 30px; 
            overflow-y: auto;
            display: none; 
            background: white; 
        }

        body.interacting .chat-history { display: flex; flex-direction: column; }

        /* --- FIXED WIDTH INPUT PILL (770px) --- */
        .chat-input-area {
            position: absolute;
            bottom: 30px; 
            left: 50%;
            transform: translateX(-50%);
            width: 770px !important; 
            display: flex;
            flex-direction: column; 
            padding: 20px 30px 15px 30px;
            background: #ffffff;
            border: 1px solid rgba(0,0,0,0.08);
            border-radius: 32px; 
            box-shadow: 0 12px 40px rgba(0,0,0,0.15); 
            z-index: 50;
        }

        textarea { background: transparent; border: none; color: #1F1F1F; font-size: 16px; outline: none; resize: none; margin-bottom: 10px; }

        /* --- MESSAGES & ASSEMBLY --- */
        .msg { margin-bottom: 30px; font-size: 16px; line-height: 1.6; color: #1F1F1F; width: 100%; }
        .msg.you { display: flex; flex-direction: column; align-items: flex-end; text-align: right; }
        .msg.you .msg-content { background: #F0F4F9; padding: 12px 20px; border-radius: 22px 0px 22px 22px; max-width: 80%; }
        
        .msg.ats { 
            display: flex; 
            flex-direction: row; 
            align-items: flex-start; 
            text-align: left; 
            gap: 12px; 
            padding-left: 80px; 
            padding-right: 20px; 
        }
        
        .msg-body { display: flex; flex-direction: column; width: 100%; }
        .msg.ats .msg-content { max-width: 100%; background: transparent; padding: 0; }

        /* --- LISTS & CODE BLOCKS --- */
        .msg-content ul { margin: 12px 0 12px 20px; }
        .msg-content li { margin-bottom: 8px; }
        pre.code-block {
            background: #F8F9FA; border: 1px solid #E3E8EF; border-radius: 8px; padding: 16px;
            margin: 12px 0; font-family: 'Courier New', Courier, monospace; font-size: 14px;
            overflow-x: auto; color: #1F1F1F;
        }
        .code-keyword { color: #d73a49; font-weight: 600; }
        .code-string { color: #032f62; }
        .code-comment { color: #6a737d; font-style: italic; }
        .code-func { color: #6f42c1; }

        /* --- BOT ICON (26px) --- */
        .bot-icon { 
            flex-shrink: 0; 
            width: 26px; 
            height: 26px; 
            margin-top: 3px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        .bot-icon img { width: 100%; height: 100%; filter: invert(37%) sepia(93%) saturate(3471%) hue-rotate(202deg) brightness(101%) contrast(107%); }

        .typing { display: none; margin-bottom: 20px; padding-left: 80px; align-items: center; gap: 12px; }

        /* --- FOOTER UI & BUTTONS --- */
        .input-footer { display: flex; justify-content: space-between; align-items: center; width: 100%; }
        .footer-left, .footer-right { display: flex; align-items: center; gap: 12px; position: relative; }
        
        .icon-btn { background: none; border: none; cursor: pointer; color: #444746; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .icon-btn svg { width: 20px; height: 20px; }
        
        .send-btn-original { background: #D7DDE8; border: none; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; }
        .send-btn-original svg { width: 24px; height: 24px; fill: #0079FF; margin-left: 2px; }

        /* STOP STATE (25px Square) */
        .send-btn-original.is-thinking svg { fill: #0079FF; width: 25px; height: 25px; margin-left: 0; }

        /* SELECTOR PILLS */
        .selector-pill { display: flex; align-items: center; gap: 8px; padding: 6px 12px; background: #F0F4F9; border: none; border-radius: 20px; cursor: pointer; height: 32px; }
        .selector-pill span { font-size: 13px; font-weight: 500; color: #444746; }
        .popup-menu { position: absolute; bottom: 45px; width: 220px; background: #ffffff; border-radius: 12px; box-shadow: 0 4px 24px rgba(0,0,0,0.15); display: none; flex-direction: column; padding: 8px 0; z-index: 70; border: 1px solid rgba(0,0,0,0.06); }
        .popup-menu.show { display: flex; }
        .menu-item { padding: 10px 16px; font-size: 14px; color: #1F1F1F; cursor: pointer; }
        .menu-item:hover { background: #F0F4F9; }

        /* --- FADE ANIMATION --- */
        @keyframes subtleFadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }
        .gemini-fade { animation: subtleFadeIn 0.5s ease forwards; }

        .thinking-wrapper { position: relative; width: 34px; height: 34px; display: flex; align-items: center; justify-content: center; }
        .thinking-ring { position: absolute; width: 100%; height: 100%; border-radius: 50%; border: 2px solid rgba(143, 41, 252, 0.1); border-top-color: #8F29FC; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .reset-btn { position: absolute; top: 10px; right: 15px; background: none; border: none; cursor: pointer; display: none; z-index: 60; padding: 15px; border-radius: 50%; }
        body.interacting .reset-btn { display: flex; }
        .reset-btn svg { width: 20px; height: 20px; fill: #1F1F1F; opacity: 0.7; }
    </style>
</head>
<body id="body">

    <div class="video-background">
        <iframe src="https://player.vimeo.com/video/1000239305?background=1&autoplay=1&loop=1&byline=0&title=0&muted=1" frameborder="0"></iframe>
    </div>
    <div class="overlay"></div>

    <nav id="navBar"><div class="nav-brand"><img src="logo.png" alt="Brambles Logo" class="logo-img"></div></nav>

    <div class="container" id="mainContainer">
        <h1>How do you want to work today?</h1>
        <p class="subtitle">Find the right analytics tools, permissions and data.</p>

        <div class="lenses-grid" id="lensesGrid">
            <div class="lens-card" onclick="triggerChat('tool', this)"><span class="lens-title">Find tools & code</span></div>
            <div class="lens-card" onclick="triggerChat('standards', this)"><span class="lens-title">Ways of working</span></div>
            <div class="lens-card" onclick="triggerChat('data', this)"><span class="lens-title">Find your tribe</span></div>
        </div>

        <div class="chat-container" id="chatContainer">
            <div class="chat-header-lintel"></div> 
            <button class="reset-btn" onclick="resetUI()">
                <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
            </button>
            <div class="chat-history" id="chatHistory">
                <div id="typingIndicator" class="typing">
                    <div class="thinking-wrapper">
                        <div class="thinking-ring"></div>
                        <div class="bot-icon"><img src="noun-ai-7305313.png" alt="ATS"></div>
                    </div>
                    <div class="msg-body"><div id="thoughtLabel" class="thought-token" style="font-size:12px;color:#1F1F1F">Thinking...</div></div>
                </div>
            </div>
            
            <div class="chat-input-area">
                <textarea id="chatInput" placeholder="Ask ATS" onkeypress="handleEnter(event)" oninput="autoExpand(this)"></textarea>
                <div class="input-footer">
                    <div class="footer-left">
                        <button class="icon-btn">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </button>
                        <button class="selector-pill" onclick="toggleMenu('modeMenu', event)">
                            <span>Job Family: <span id="currentMode" style="color:#5f6368">Auto</span></span>
                        </button>
                        <div class="popup-menu" id="modeMenu" style="left:40px">
                            <div class="menu-item" onclick="selectMode('Auto')">Auto</div>
                            <div class="menu-item" onclick="selectMode('ML/Data science')">ML/Data science</div>
                            <div class="menu-item" onclick="selectMode('Data Analysis')">Data Analysis</div>
                            <div class="menu-item" onclick="selectMode('Data Engineering')">Data Engineering</div>
                            <div class="menu-item" onclick="selectMode('Visualisation Engineering')">Visualisation Engineering</div>
                            <div class="menu-item" onclick="selectMode('Process Automation')">Process Automation</div>
                        </div>
                    </div>
                    <div class="footer-right">
                        <button class="selector-pill" onclick="toggleMenu('proficiencyMenu', event)">
                            <span>Proficiency: <span id="currentProfLabel">Auto</span></span>
                        </button>
                        <div class="popup-menu" id="proficiencyMenu" style="right:60px">
                            <div class="menu-item" onclick="selectProficiency('Auto')">Auto</div>
                            <div class="menu-item" onclick="selectProficiency('Low code')">Low code</div>
                            <div class="menu-item" onclick="selectProficiency('Code first')">Code first</div>
                        </div>
                        <button id="sendBtn" class="send-btn-original" onclick="handleButtonClick()">
                            <svg id="sendIcon" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="artifacts-panel" id="artifactsPanel">
            <div class="artifact-header">Resources & Artifacts</div>
            <div class="artifact-card">
                <div class="type">DOCUMENTATION</div>
                <span class="title">Azure Databricks Setup Guide</span>
                <div class="meta">PDF â€¢ 2.4 MB</div>
            </div>
            <div class="artifact-card">
                <div class="type">INTERNAL LINK</div>
                <span class="title">Brambles Data Governance Portal</span>
                <div class="meta">governance.brambles.com</div>
            </div>
        </div>
    </div>

    <script>
        const chatHistory = document.getElementById('chatHistory');
        const typingIndicator = document.getElementById('typingIndicator');
        const thoughtLabel = document.getElementById('thoughtLabel');
        const body = document.getElementById('body');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const sendIcon = document.getElementById('sendIcon');

        const modeColors = { 
            'Auto': '#5f6368', 
            'ML/Data science': '#1a73e8', 
            'Data Analysis': '#1e8e3e', 
            'Data Engineering': '#f9ab00', 
            'Visualisation Engineering': '#9334e6', 
            'Process Automation': '#d93025' 
        };

        let isThinking = false;
        let stopThinking = false;

        const dummyThoughts = ["Scanning tool stack...", "Checking governance...", "Formulating recommendation..."];
        const sendPath = "M2.01 21L23 12 2.01 3 2 10l15 2-15 2z";
        const stopPath = "M6 6h12v12H6z";

        function toggleMenu(id, e) { e.stopPropagation(); document.getElementById(id).classList.toggle('show'); }

        function selectMode(m) { 
            const label = document.getElementById('currentMode');
            label.innerText = m; 
            label.style.color = modeColors[m] || '#5f6368';
            simulateThinking(`Job Family mode set to **${m}**.
            <ul>
                <li>Prioritizing technical documentation for ${m}.</li>
                <li>Filtering tool stack for domain-specific patterns.</li>
            </ul>`); 
        }

        function selectProficiency(p) { document.getElementById('currentProfLabel').innerText = p; simulateThinking(`Adjusting responses for **${p}** technical level.`); }

        function handleButtonClick() { if (isThinking) { stopThinking = true; } else { sendUserMessage(); } }

        function setThinkingState(state) {
            isThinking = state;
            if (state) {
                sendBtn.classList.add('is-thinking');
                sendIcon.querySelector('path').setAttribute('d', stopPath);
            } else {
                sendBtn.classList.remove('is-thinking');
                sendIcon.querySelector('path').setAttribute('d', sendPath);
                typingIndicator.style.display = 'none';
            }
        }

        async function simulateThinking(finalText) {
            setThinkingState(true);
            stopThinking = false;
            typingIndicator.style.display = 'flex';
            chatHistory.scrollTop = chatHistory.scrollHeight;
            for (const thought of dummyThoughts) {
                if (stopThinking) break;
                thoughtLabel.innerText = thought;
                await new Promise(r => setTimeout(r, 800));
                chatHistory.scrollTop = chatHistory.scrollHeight;
            }
            if (!stopThinking) { addMessage(finalText, 'ATS'); }
            setThinkingState(false);
        }

        function sendUserMessage() {
            body.classList.add('interacting');
            const text = chatInput.value.trim();
            if(!text) return;
            addMessage(text, 'You');
            chatInput.value = '';
            const response = `Based on your request, I recommend utilizing a standard Azure Databricks cluster:
            <pre class="code-block"><span class="code-keyword">import</span> databricks.koalas <span class="code-keyword">as</span> ks
df = ks.<span class="code-func">read_csv</span>(<span class="code-string">"dbfs:/mnt/data.csv"</span>)</pre>
            <ul><li>Scalable compute nodes.</li><li>Shared tribe workspace.</li><li>Seamless lake integration.</li></ul>`;
            simulateThinking(response);
        }

        function addMessage(text, sender) {
            const div = document.createElement('div');
            div.className = `msg ${sender.toLowerCase()}`;
            if (sender === 'ATS') { 
                div.innerHTML = `<div class="bot-icon"><img src="noun-ai-7305313.png" alt="ATS"></div>
                                 <div class="msg-body"><div class="msg-content gemini-fade">${text}</div></div>`; 
            } else { div.innerHTML = `<div class="msg-content">${text}</div>`; }
            chatHistory.insertBefore(div, typingIndicator);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        function triggerChat(lens, element) { 
            body.classList.add('interacting'); 
            addMessage(`I am ATS, your assistant. I can help you:
            <ul><li>Find code snippets.</li><li>Access standards.</li><li>Connect with communities.</li></ul>`, 'ATS'); 
            chatInput.focus();
        }

        function resetUI() { body.classList.remove('interacting'); }
        function autoExpand(el) { el.style.height = 'auto'; el.style.height = (el.scrollHeight) + 'px'; }
        function handleEnter(e) { if(e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); handleButtonClick(); } }
        window.onclick = () => document.querySelectorAll('.popup-menu').forEach(m => m.classList.remove('show'));
    </script>
</body>
</html>
